‘ HTML Code Generator
’ The following code was created to generate custom HTML web pages based on 
‘ data contained in a spreadsheet.
‘ The spreadsheet model is available upon request.

Option ExplicitType photoItem    Key As Integer ' unique list key    Name As String 'photo name    Directory As String ' master directory    DirectoryLocal As String ' local directory    TitLe As String ' ?    Heading As String ' Page Caption    ' are these next two really necessary?    Next As Integer 'aka Next image's key    Last As Integer 'aka Last image's key    Caption As String ' Image caption    Orientation As String    bigHeight As Integer    bigWidth As Integer    smallHeight As Integer    smallWidth As Integer    published As BooleanEnd TypePublic photoCandidate() As photoItemPublic photoWeb() As photoItemPublic p As Integer ' candidate photo counterPublic w As Integer ' web photo counterSub run()    ' get list of candidate photos    getCandidateList    ' get list of photos already on web    getWebList    'display dialog to select photos from candidates    form_add_photos.ShowEnd SubPrivate Sub getCandidateList()    Dim dirNum As Integer    Dim directoryMaster As String    Dim DirectoryLocal As String    Dim resolutionSet As String    Dim directoryList(500) As String    Dim fs As Object 'fileSearch object    Dim i As Integer ' first dimension counter    Dim j As Integer ' second dimension counter          'config settings     resolutionSet = "\medium res"          'initialize photoItem array     ReDim photoCandidate(0)          'create list of directories    directoryMaster = "C:\My Documents\Common Items\Photos\2001-, from Christian's birth\"    DirectoryLocal = Dir(directoryMaster, vbDirectory)    dirNum = 0    i = 0    Do While DirectoryLocal <> "" 'Start the loop        'Debug.Print directoryLocal        If DirectoryLocal <> "." And DirectoryLocal <> ".." Then            If (GetAttr(directoryMaster & DirectoryLocal) And vbDirectory) = vbDirectory Then                directoryList(i) = DirectoryLocal                dirNum = i                i = i + 1            End If        End If       DirectoryLocal = Dir    Loop        'write directory list to a sheet, sort, and re-read sorted list    Application.Sheets.Add    For i = 0 To dirNum        Range("a" & i + 1) = directoryList(i)    Next i    Range("a1:a" & dirNum + 1).Select    Range("a1:a" & dirNum + 1).Sort key1:=Cells(1, 1), order1:=xlAscending, header:=xlNo   For i = 0 To dirNum        directoryList(i) = Range("a" & i + 1)    Next i    Application.DisplayAlerts = False    ActiveSheet.Delete    Application.DisplayAlerts = True       'for each directory, read photo candidates    Set fs = Application.FileSearch    p = 0 ' candidate photo counter    For i = 0 To dirNum       With fs            .NewSearch            .LookIn = directoryMaster & directoryList(i) & resolutionSet            .FileType = msoFileTypeAllFiles            .Execute            ReDim Preserve photoCandidate(UBound(photoCandidate) + .FoundFiles.count)            For j = 1 To .FoundFiles.count                photoCandidate(p).Directory = directoryMaster & directoryList(i) & resolutionSet                photoCandidate(p).DirectoryLocal = directoryList(i) & resolutionSet                photoCandidate(p).Name = Trim(Mid(.FoundFiles(j), InStr(.FoundFiles(j), directoryList(i)) + Len(directoryList(i)) + 1 + Len(resolutionSet), 100))                photoCandidate(p).Orientation = "L"                If Mid(directoryList(i), 4, 1) = " " Then                    photoCandidate(p).TitLe = "p0" & Left(directoryList(i), 3)                Else                    photoCandidate(p).TitLe = "p" & Left(directoryList(i), 4)                End If                photoCandidate(p).published = False                p = p + 1            Next j        End With    Next i    ' do I really want to do this?    ReDim Preserve photoCandidate(UBound(photoCandidate) - 1)    End Sub    Private Sub getWebList()        Sheets("webPhotos").Select    Range("a1").Activate        'count images to load    Dim rowNum As Integer    'rowNum = ActiveCell.CurrentRegion.Rows.count - 2 'subtract 1 for header row , and 1 more for 0 position in array?    rowNum = ActiveCell.CurrentRegion.Rows.count - 1 'subtract 1 for header row         'initialize photoItem array    ReDim photoWeb(rowNum)        For w = 0 To rowNum            photoWeb(w).Key = Range("a" & w + 2).Value        photoWeb(w).DirectoryLocal = Range("b" & w + 2).Value        photoWeb(w).TitLe = Range("c" & w + 2).Value        photoWeb(w).Heading = Range("d" & w + 2).Value        photoWeb(w).Name = Range("e" & w + 2).Value'        photoWeb(w).Next = Range("f" & w+1).Value'        photoWeb(w).Last = Range("g" & w+1).Value        photoWeb(w).Caption = Range("h" & w + 2).Value        photoWeb(w).Orientation = Range("i" & w + 2).Value        photoWeb(w).bigHeight = Range("j" & w + 2).Value        photoWeb(w).bigWidth = Range("k" & w + 2).Value        photoWeb(w).smallHeight = Range("l" & w + 2).Value        photoWeb(w).smallWidth = Range("m" & w + 2).Value        photoWeb(w).published = True    Next wEnd Sub