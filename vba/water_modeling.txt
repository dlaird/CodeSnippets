‘ Water Pricing Model Code
’ The following code was created to support a spreadsheet-based water pricing model
‘ used to calculate income and community impact analyses stemming from a change 
‘ from a flat-fee water pricing scheme to a usage-based tiered pricing system.
‘ The spreadsheet model is available upon request.
Function revenue(Usage, BaseRate, UseTier1, UseTier2, UseTier3, UseTier4, TierFactor1, TierFactor2, TierFactor3, TierFactor4, TierFactor5, MonthlyLevelTier, LevelFactor1, LevelFactor2, LevelFactor3, LevelFactor4, LevelFactor5)If VarType(Usage) = vbError Then Usage = 0RevenueUsageTier1 = 0RevenueUsageTier2 = 0RevenueUsageTier3 = 0RevenueUsageTier4 = 0RevenueUsageTier5 = 0' Calculate Revenue According to Usage TiersIf Usage <= UseTier1 Then    RevenueUsageTier1 = BaseRate * TierFactor1 * (Usage / 1000)ElseIf Usage <= UseTier2 Then    RevenueUsageTier1 = BaseRate * TierFactor1 * (UseTier1 / 1000)    RevenueUsageTier2 = BaseRate * TierFactor2 * ((Usage - UseTier1) / 1000)ElseIf Usage <= UseTier3 Then    RevenueUsageTier1 = BaseRate * TierFactor1 * (UseTier1 / 1000)    RevenueUsageTier2 = BaseRate * TierFactor2 * ((UseTier2 - UseTier1) / 1000)    RevenueUsageTier3 = BaseRate * TierFactor3 * ((Usage - UseTier2) / 1000)ElseIf Usage <= UseTier4 Then    RevenueUsageTier1 = BaseRate * TierFactor1 * (UseTier1 / 1000)    RevenueUsageTier2 = BaseRate * TierFactor2 * ((UseTier2 - UseTier1) / 1000)    RevenueUsageTier3 = BaseRate * TierFactor3 * ((UseTier3 - UseTier2) / 1000)    RevenueUsageTier4 = BaseRate * TierFactor4 * ((Usage - UseTier3) / 1000)Else    RevenueUsageTier1 = BaseRate * TierFactor1 * (UseTier1 / 1000)    RevenueUsageTier2 = BaseRate * TierFactor2 * ((UseTier2 - UseTier1) / 1000)    RevenueUsageTier3 = BaseRate * TierFactor3 * ((UseTier3 - UseTier2) / 1000)    RevenueUsageTier4 = BaseRate * TierFactor4 * ((UseTier4 - UseTier3) / 1000)    RevenueUsageTier5 = BaseRate * TierFactor5 * ((Usage - UseTier4) / 1000)End If' Total Revenue According to Usage Tiersrevenue = RevenueUsageTier1 + RevenueUsageTier2 + RevenueUsageTier3 + RevenueUsageTier4 + RevenueUsageTier5' Adjust Revenue According to Water Level TiersIf MonthlyLevelTier = 1 Then    revenue = revenue * LevelFactor1ElseIf MonthlyLevelTier = 2 Then    revenue = revenue * LevelFactor2ElseIf MonthlyLevelTier = 3 Then    revenue = revenue * LevelFactor3ElseIf MonthlyLevelTier = 4 Then    revenue = revenue * LevelFactor4ElseIf MonthlyLevelTier = 5 Then    revenue = revenue * LevelFactor5Else    revenue = -1End IfEnd FunctionFunction WaterBill(Base, Fixed, Cut1, Cut2, Cut3, Cut4, Mult1, Mult2, Mult3, Mult4, Mult5, Usage)If VarType(Usage) = vbError Then Usage = 0UseTier1 = 0UseTier2 = 0UseTier3 = 0UseTier4 = 0UseTier5 = 0WaterBill = 0UseTier1 = Min(Usage, Cut1)If Usage > UseTier1 Then UseTier2 = Min(Usage - UseTier1, Cut2) Else UseTier2 = Max(Usage - Cut1, 0)If Usage > UseTier2 Then UseTier3 = Min(Usage - UseTier2, Cut3) Else UseTier3 = Max(Usage - Cut2, 0)If Usage > UseTier3 Then UseTier4 = Min(Usage - UseTier3, Cut4) Else UseTier4 = Max(Usage - Cut3, 0)If Usage > UseTier4 Then UseTier5 = Min(Usage - UseTier4, Cut5) Else UseTier5 = Max(Usage - Cut4, 0)RevenueTier1 = UseTier1 * Base * Mult1RevenueTier2 = UseTier2 * Base * Mult2RevenueTier3 = UseTier3 * Base * Mult3RevenueTier4 = UseTier4 * Base * Mult4RevenueTier5 = UseTier5 * Base * Mult5WaterBill = Fixed + RevenueTier1 + RevenueTier2 + RevenueTier3 + RevenueTier4 + RevenueTier5